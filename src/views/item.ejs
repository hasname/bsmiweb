<!doctype html>
<html lang="zh-Hant-TW">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title><%= registration.id %> — BSMI 檢驗標識查詢</title>
<meta name="description" content="BSMI 檢驗標識 <%= registration.id %> — <%= registration.applicant %>（統編 <%= registration.taxId %>），共 <%= registration.certificates.length %> 張證書">
<link rel="canonical" href="<%= canonicalUrl %>">
<meta property="og:title" content="<%= registration.id %> — BSMI 檢驗標識查詢">
<meta property="og:description" content="<%= registration.applicant %>（統編 <%= registration.taxId %>）— 共 <%= registration.certificates.length %> 張證書">
<meta property="og:type" content="website">
<meta property="og:url" content="<%= canonicalUrl %>">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="<%= registration.id %> — BSMI 檢驗標識查詢">
<meta name="twitter:description" content="<%= registration.applicant %>（統編 <%= registration.taxId %>）— 共 <%= registration.certificates.length %> 張證書">
<script type="application/ld+json">
<%- JSON.stringify({
  "@context": "https://schema.org",
  "@type": "Organization",
  "name": registration.applicant,
  "taxID": registration.taxId,
  "telephone": registration.phone,
  "address": {
    "@type": "PostalAddress",
    "streetAddress": registration.companyAddr
  },
  "url": canonicalUrl
}) %>
</script>
<style>
body { font-family: sans-serif; margin: 2em; }
table { border-collapse: collapse; width: 100%; margin-top: 1em; }
th, td { border: 1px solid #ccc; padding: 0.5em; text-align: left; }
th { background: #f5f5f5; }
dl { display: grid; grid-template-columns: 8em 1fr; align-items: baseline; margin: 0; }
dt { font-weight: bold; }
dd { margin: 0; }
</style>
</head>
<body>
<h1>檢驗標識 <%= registration.id %></h1>

<h2>廠商資料</h2>
<dl>
  <dt>標識號碼</dt><dd><%= registration.id %></dd>
  <dt>統編</dt><dd><a href="/ban/<%= registration.taxId %>"><%= registration.taxId %></a></dd>
  <dt>申請人</dt><dd><%= registration.applicant %></dd>
  <dt>聯絡地址</dt><dd><%= registration.contactAddr %></dd>
  <dt>公司地址</dt><dd><%= registration.companyAddr %></dd>
  <dt>電話</dt><dd><%= registration.phone %></dd>
  <% if (registration.note) { %>
  <dt>備註</dt><dd><%= registration.note %></dd>
  <% } %>
</dl>

<h2>證書列表</h2>
<% if (registration.certificates.length === 0) { %>
<p>無證書資料。</p>
<% } else { %>
<table>
<thead>
<tr>
  <th>證書編號</th>
  <th>有效期間</th>
  <th style="white-space: nowrap">狀態</th>
  <th>產品名稱</th>
  <th>主型式</th>
  <th>系列型號</th>
  <th style="white-space: nowrap">發證單位</th>
</tr>
</thead>
<tbody>
<% for (const cert of registration.certificates) { %>
<tr>
  <td><%= cert.id %></td>
  <td><%= cert.validDate %></td>
  <td><%= cert.status %></td>
  <td><%= cert.productName %></td>
  <td><%= cert.mainModel %></td>
  <td><%= cert.seriesModels.split('\n').filter(s => s).join(', ') %></td>
  <td><%= cert.issuer %></td>
</tr>
<% } %>
</tbody>
</table>
<% } %>
</body>
</html>
