<!doctype html>
<html lang="zh-Hant-TW">
<head>
<meta charset="utf-8">
<title><%= registration.id %> — BSMI 檢驗標識查詢</title>
<meta property="og:title" content="<%= registration.id %> — BSMI 檢驗標識查詢">
<meta property="og:description" content="<%= registration.applicant %>（統編 <%= registration.taxId %>）— 共 <%= registration.certificates.length %> 張證書">
<meta property="og:type" content="website">
<style>
body { font-family: sans-serif; margin: 2em; }
table { border-collapse: collapse; width: 100%; margin-top: 1em; }
th, td { border: 1px solid #ccc; padding: 0.5em; text-align: left; }
th { background: #f5f5f5; }
dl { display: grid; grid-template-columns: 8em 1fr; gap: 0.25em 1em; }
dt { font-weight: bold; }
</style>
</head>
<body>
<h1>檢驗標識 <%= registration.id %></h1>

<h2>廠商資料</h2>
<dl>
  <dt>標識號碼</dt><dd><%= registration.id %></dd>
  <dt>統編</dt><dd><%= registration.taxId %></dd>
  <dt>申請人</dt><dd><%= registration.applicant %></dd>
  <dt>聯絡地址</dt><dd><%= registration.contactAddr %></dd>
  <dt>公司地址</dt><dd><%= registration.companyAddr %></dd>
  <dt>電話</dt><dd><%= registration.phone %></dd>
  <% if (registration.note) { %>
  <dt>備註</dt><dd><%= registration.note %></dd>
  <% } %>
</dl>

<h2>證書列表</h2>
<% if (registration.certificates.length === 0) { %>
<p>無證書資料。</p>
<% } else { %>
<table>
<thead>
<tr>
  <th>證書編號</th>
  <th>有效期間</th>
  <th>狀態</th>
  <th>產品名稱</th>
  <th>主型式</th>
  <th>系列型號</th>
  <th>發證單位</th>
</tr>
</thead>
<tbody>
<% for (const cert of registration.certificates) { %>
<tr>
  <td><%= cert.id %></td>
  <td><%= cert.validDate %></td>
  <td><%= cert.status %></td>
  <td><%= cert.productName %></td>
  <td><%= cert.mainModel %></td>
  <td><%= cert.seriesModels.split('\n').filter(s => s).join(', ') %></td>
  <td><%= cert.issuer %></td>
</tr>
<% } %>
</tbody>
</table>
<% } %>
</body>
</html>
