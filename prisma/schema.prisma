// This is your Prisma schema file,
// learn more about it in the docs: https://pris.ly/d/prisma-schema

// Looking for ways to speed up your queries, or scale easily with your serverless or edge functions?
// Try Prisma Accelerate: https://pris.ly/cli/accelerate-init

generator client {
  provider = "prisma-client"
  output   = "../src/generated/prisma"
}

datasource db {
  provider = "mysql"
}

model Registration {
  id           String        @id // e.g. "R45879"
  taxId        String // 統編
  applicant    String // 申請人
  contactAddr  String        @db.Text // 聯絡地址
  companyAddr  String        @db.Text // 公司地址
  phone        String // 電話
  note         String        @db.Text // 廠商資料備註
  createdAt    DateTime      @default(now())
  updatedAt    DateTime      @updatedAt
  certificates Certificate[]
}

model Certificate {
  id             String       @id // 證書編號, e.g. "CI450068790054"
  registrationId String
  validDate      String // 有效期間 (民國日期, e.g. "1130202")
  status         String // 證書狀態 (認可/期限到期失效/註銷)
  productName    String       @db.Text // 產品中文名稱
  soldAs         String       @db.Text // 以他人名義銷售
  mainModel      String // 主型式
  seriesModels   String       @db.Text // 系列型號 (newline-separated)
  issuer         String // 發證單位
  createdAt      DateTime     @default(now())
  updatedAt      DateTime     @updatedAt
  registration   Registration @relation(fields: [registrationId], references: [id])

  @@index([registrationId])
}

model Authorization {
  id              String   @id // 授權證號, e.g. "CI311072080028"
  certificateId   String // 原始證書編號
  authorizerName  String // 授權人名稱
  mainModel       String // 主型式
  authorizeeTaxId String // 被授權人統編
  authorizeeName  String // 被授權人名稱
  authorizeeAddr  String   @db.Text // 被授權人地址
  authorizeePhone String // 被授權人電話
  validDate       String // 授權有效時間, e.g. "2005/07/18"
  createdAt       DateTime @default(now())
  updatedAt       DateTime @updatedAt

  @@index([certificateId])
  @@index([authorizeeTaxId])
}
